<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Bookwell</title>
    
    <!-- MDBootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-logo">
                <div class="logo-icon mx-auto" style="width: 60px; height: 60px; font-size: 30px;">
                    <i class="fas fa-book-open"></i>
                </div>
            </div>
            
            <h2 class="auth-title">Welcome to Bookwell</h2>
            <p class="auth-subtitle">Login or create an account to start reading.</p>
            
            <!-- Tabs -->
            <div class="auth-tabs">
                <div class="auth-tab active" id="loginTab">Login</div>
                <div class="auth-tab" id="signupTab">Sign Up</div>
            </div>
            
            <!-- Login Form -->
            <form id="loginForm">
                <div class="mb-4">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="loginEmail" placeholder="you@example.com" required>
                </div>
                
                <div class="mb-4">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="loginPassword" placeholder="••••••••" required>
                </div>
                
                <div class="text-end mb-4">
                    <a href="#" class="text-decoration-none" style="color: var(--primary-green);" id="forgotPasswordLink">
                        Forgot Password?
                    </a>
                </div>
                
                <button type="submit" class="btn btn-primary btn-rounded w-100 mb-3">
                    Login
                </button>
            </form>
            
            <!-- Signup Form (Hidden by default) -->
            <form id="signupForm" style="display: none;">
                <div class="mb-4">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-control" id="signupName" placeholder="John Doe" required>
                </div>
                
                <div class="mb-4">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="signupEmail" placeholder="you@example.com" required>
                </div>
                
                <div class="mb-4">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="signupPassword" placeholder="••••••••" required minlength="6">
                    <div class="form-text">Password must be at least 6 characters</div>
                </div>
                
                <button type="submit" class="btn btn-primary btn-rounded w-100 mb-3">
                    Create Account
                </button>
            </form>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div class="modal fade" id="forgotPasswordModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Reset Password</h5>
                    <button type="button" class="btn-close" data-mdb-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Enter your email address and we'll send you a link to reset your password.</p>
                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="resetEmail" placeholder="you@example.com" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="resetPasswordBtn">Send Reset Link</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    
    <!-- MDBootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.js"></script>
    
    <!-- Custom JS -->
    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Tab switching
            const loginTab = document.getElementById('loginTab');
            const signupTab = document.getElementById('signupTab');
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            
            loginTab.addEventListener('click', () => {
                loginTab.classList.add('active');
                signupTab.classList.remove('active');
                loginForm.style.display = 'block';
                signupForm.style.display = 'none';
            });
            
            signupTab.addEventListener('click', () => {
                signupTab.classList.add('active');
                loginTab.classList.remove('active');
                signupForm.style.display = 'block';
                loginForm.style.display = 'none';
            });
            
            // Login form submission
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                await loginWithEmail(email, password);
            });
            
            // Signup form submission
            signupForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('signupName').value;
                const email = document.getElementById('signupEmail').value;
                const password = document.getElementById('signupPassword').value;
                await signupWithEmail(name, email, password);
            });
            
            // Forgot password
            document.getElementById('forgotPasswordLink').addEventListener('click', (e) => {
                e.preventDefault();
                const modal = new mdb.Modal(document.getElementById('forgotPasswordModal'));
                modal.show();
            });
            
            document.getElementById('resetPasswordBtn').addEventListener('click', async () => {
                const email = document.getElementById('resetEmail').value;
                if (email) {
                    const success = await resetPassword(email);
                    if (success) {
                        const modal = mdb.Modal.getInstance(document.getElementById('forgotPasswordModal'));
                        modal.hide();
                        document.getElementById('resetEmail').value = ''; // Clear input
                    }
                } else {
                    showToast('Please enter your email', 'error');
                }
            });
        });
    </script>
</body>
</html>
